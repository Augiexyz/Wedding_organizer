{% comment %} organizer/templates/organizer/kelola_pesanan.html {% endcomment %}
{% load humanize %}
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelola Pesanan - Wedding Organizer Samarinda</title>
    <!-- ... (Semua link head Anda) ... -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #FDF2F8; }
        .font-serif-display { font-family: 'Playfair Display', serif; }
        .text-primary-dark { color: #831843; }
        .bg-primary-dark { background-color: #831843; }
        .status-waiting { background-color: #FEF3C7; color: #92400E; }
        .status-dikonfirmasi { background-color: #D1FAE5; color: #065F46; }
        .status-dibatalkan { background-color: #FEE2E2; color: #991B1B; }
        .status-selesai { background-color: #DBEAFE; color: #1E40AF; }
        .tab-button { padding: 0.75rem 1.5rem; font-weight: 600; color: #4B5563; border-bottom: 3px solid transparent; transition: all 0.3s ease; }
        .tab-button.active, .tab-button:hover { color: #DB2777; border-bottom-color: #DB2777; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body class="min-h-screen">
    <div class="flex">
        <!-- Sidebar -->
        <aside class="w-64 bg-primary-dark text-white p-6 hidden lg:block min-h-screen shadow-lg">
            <h1 class="text-2xl font-serif-display font-bold mb-8">Wedding Organizer Samarinda</h1>
            <nav>
                <ul class="space-y-4">
                    <li><a href="{% url 'dashboard_wo' %}" class="flex items-center p-2 text-gray-300 rounded-lg hover:bg-pink-800"><i data-feather="home" class="w-5 h-5 mr-3"></i>Dashboard</a></li>
                    <li><a href="{% url 'kelola_pesanan' %}" class="flex items-center p-2 bg-pink-700 font-bold rounded-lg"><i data-feather="shopping-bag" class="w-5 h-5 mr-3"></i>Kelola Pesanan</a></li>
                    <li><a href="{% url 'kelola_paket' %}" class="flex items-center p-2 text-gray-300 rounded-lg hover:bg-pink-800"><i data-feather="archive" class="w-5 h-5 mr-3"></i>Kelola Paket</a></li>
                    <li><a href="{% url 'edit_profil_wo' %}" class="flex items-center p-2 text-gray-300 rounded-lg hover:bg-pink-800"><i data-feather="user" class="w-5 h-5 mr-3"></i>Profil WO</a></li>
<li>
    <form action="{% url 'logout' %}" method="post" class="w-full">
        {% csrf_token %}
        <button type="submit" class="flex items-center p-2 text-gray-300 rounded-lg hover:bg-pink-800 w-full">
            <i data-feather="log-out" class="w-5 h-5 mr-3"></i>Logout
        </button>
    </form>
</li>                </ul>
            </nav>
        </aside>

        <!-- Konten Utama -->
        <main class="flex-1 p-6 md:p-10">
            <header class="mb-8">
                <h2 class="text-3xl font-serif-display text-primary-dark">Kelola Pesanan</h2>
                <p class="text-gray-500 mt-1">Lihat dan kelola semua pesanan dari pelanggan Anda.</p>
            </header>

            <div class="bg-white rounded-2xl shadow-lg">
                <!-- Navigasi Tab -->
                <div class="border-b border-gray-200">
                    <nav class="flex -mb-px" id="tabs">
                        <button class="tab-button active" data-target="pesanan-masuk">Pesanan Masuk ({{ pesanan_masuk.count }})</button>
                        <button class="tab-button" data-target="riwayat-pesanan">Riwayat Pesanan</button>
                    </nav>
                </div>

                <!-- Konten Tab -->
                <div class="p-6 md:p-8">
                    <!-- Tab 1: Pesanan Masuk -->
                    <div id="pesanan-masuk" class="tab-content active">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4 font-semibold text-gray-600">Pelanggan</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Paket</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Tgl Acara</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Status</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Aksi</th>
                                    </tr>
                                </thead>
                                <!-- ... (thead sama) ... -->
                                <tbody>
                                    {% for pesanan in pesanan_masuk %}
                                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                                        <td class="py-4 px-4 font-medium">{{ pesanan.customer.get_full_name|default:pesanan.customer.username }}</td>
                                        <td class="py-4 px-4">{{ pesanan.paket.nama_paket }}</td>
                                        <td class="py-4 px-4">{{ pesanan.tgl_acara|date:"d M Y" }}</td>
                                        <td class="py-4 px-4"><span class="px-3 py-1 text-xs font-medium rounded-full status-{{ pesanan.status }}">{{ pesanan.get_status_display }}</span></td>
                                        <td class="py-4 px-4"><a href="{% url 'detail_pesanan' pesanan.id %}" class="text-pink-600 hover:underline font-semibold">Lihat Detail</a></td>
                                    </tr>
                                    {% empty %}
                                    <tr><td colspan="5" class="text-center py-10 text-gray-500">Tidak ada pesanan yang masuk saat ini.</td></tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab 2: Riwayat Pesanan -->
                    <div id="riwayat-pesanan" class="tab-content">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4 font-semibold text-gray-600">Pelanggan</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Paket</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Tgl Acara</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Status</th>
                                        <th class="py-3 px-4 font-semibold text-gray-600">Aksi</th>
                                    </tr>
                                </thead>
                                <!-- ... (thead sama) ... -->
                                <tbody>
                                    {% for pesanan in riwayat_pesanan %}
                                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                                        <td class="py-4 px-4 font-medium">{{ pesanan.customer.get_full_name|default:pesanan.customer.username }}</td>
                                        <td class="py-4 px-4">{{ pesanan.paket.nama_paket }}</td>
                                        <td class="py-4 px-4">{{ pesanan.tgl_acara|date:"d M Y" }}</td>
                                        <td class="py-4 px-4"><span class="px-3 py-1 text-xs font-medium rounded-full status-{{ pesanan.status }}">{{ pesanan.get_status_display }}</span></td>
                                        <td class="py-4 px-4"><a href="{% url 'detail_pesanan' pesanan.id %}" class="text-pink-600 hover:underline font-semibold">Lihat Detail</a></td>
                                    </tr>
                                    {% empty %}
                                    <tr><td colspan="5" class="text-center py-10 text-gray-500">Tidak ada riwayat pesanan.</td></tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        feather.replace();

        // Script untuk fungsionalitas Tab
        const tabs = document.getElementById('tabs');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.addEventListener('click', (event) => {
            const targetButton = event.target.closest('button');
            if (!targetButton) return;

            // Nonaktifkan semua tombol dan konten
            tabs.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));

            // Aktifkan tombol dan konten yang dipilih
            targetButton.classList.add('active');
            const targetContentId = targetButton.getAttribute('data-target');
            document.getElementById(targetContentId).classList.add('active');
        });
    </script>
</body>
</html>
